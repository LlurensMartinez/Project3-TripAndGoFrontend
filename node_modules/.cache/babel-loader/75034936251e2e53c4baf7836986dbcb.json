{"ast":null,"code":"import _classCallCheck from \"/Users/miguel/ironhack/project/m3-frontend-master/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/miguel/ironhack/project/m3-frontend-master/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/miguel/ironhack/project/m3-frontend-master/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/miguel/ironhack/project/m3-frontend-master/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/miguel/ironhack/project/m3-frontend-master/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/miguel/ironhack/project/m3-frontend-master/src/providers/AuthProvider.js\";\nimport React, { Component } from 'react';\nimport authService from '../lib/auth-service';\nexport var AuthContext = React.createContext();\nvar Provider = AuthContext.Provider,\n    Consumer = AuthContext.Consumer;\nexport var withAuth = function withAuth(Comp) {\n  return (\n    /*#__PURE__*/\n    function (_Component) {\n      _inherits(WithAuth, _Component);\n\n      function WithAuth() {\n        _classCallCheck(this, WithAuth);\n\n        return _possibleConstructorReturn(this, _getPrototypeOf(WithAuth).apply(this, arguments));\n      }\n\n      _createClass(WithAuth, [{\n        key: \"render\",\n        value: function render() {\n          var _this = this;\n\n          return React.createElement(Consumer, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 14\n            },\n            __self: this\n          }, function (authStore) {\n            return React.createElement(Comp, Object.assign({\n              isLogged: authStore.isLogged,\n              user: authStore.user,\n              logout: authStore.logout,\n              login: authStore.login,\n              signup: authStore.signup\n            }, _this.props, {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 16\n              },\n              __self: this\n            }));\n          });\n        }\n      }]);\n\n      return WithAuth;\n    }(Component)\n  );\n};\n\nvar AuthProvider =\n/*#__PURE__*/\nfunction (_Component2) {\n  _inherits(AuthProvider, _Component2);\n\n  function AuthProvider() {\n    var _getPrototypeOf2;\n\n    var _this2;\n\n    _classCallCheck(this, AuthProvider);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this2 = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(AuthProvider)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this2.state = {\n      isLogged: false,\n      user: {},\n      status: 'loading'\n    };\n\n    _this2.setUser = function (user) {\n      _this2.setState({\n        isLogged: true,\n        user: user\n      });\n    };\n\n    _this2.logoutUser = function () {\n      return authService.logout().then(function () {\n        _this2.setState({\n          isLogged: false,\n          user: {}\n        });\n      }).catch(function (error) {\n        return console.log(error);\n      });\n    };\n\n    _this2.loginUser = function (body) {\n      return authService.login(body).then(function (user) {\n        _this2.setUser(user);\n      }).catch(function (error) {\n        return console.log(error);\n      });\n    };\n\n    _this2.signupUser = function (body) {\n      return authService.signup(body).then(function (user) {\n        _this2.setUser(user);\n      }).catch(function (error) {\n        return console.log(error);\n      });\n    };\n\n    return _this2;\n  }\n\n  _createClass(AuthProvider, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this3 = this;\n\n      authService.me().then(function (user) {\n        _this3.setState({\n          isLogged: true,\n          user: user,\n          status: 'loaded'\n        });\n      }).catch(function (error) {\n        _this3.setState({\n          isLogged: false,\n          user: {},\n          status: 'loaded'\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          isLogged = _this$state.isLogged,\n          user = _this$state.user,\n          status = _this$state.status;\n      var children = this.props.children;\n\n      switch (status) {\n        case 'loading':\n          return React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 94\n            },\n            __self: this\n          }, \"Loading\");\n\n        default:\n          return React.createElement(Provider, {\n            value: {\n              isLogged: isLogged,\n              user: user,\n              logout: this.logoutUser,\n              login: this.loginUser,\n              signup: this.signupUser\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 97\n            },\n            __self: this\n          }, children);\n      }\n    }\n  }]);\n\n  return AuthProvider;\n}(Component);\n\nexport { AuthProvider as default };","map":{"version":3,"sources":["/Users/miguel/ironhack/project/m3-frontend-master/src/providers/AuthProvider.js"],"names":["React","Component","authService","AuthContext","createContext","Provider","Consumer","withAuth","Comp","authStore","isLogged","user","logout","login","signup","props","AuthProvider","state","status","setUser","setState","logoutUser","then","catch","error","console","log","loginUser","body","signupUser","me","children"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport authService from '../lib/auth-service';\n\nexport const AuthContext = React.createContext(\n  // authStore // default value\n);\n\nconst { Provider, Consumer }  = AuthContext;\n\nexport const withAuth = (Comp) => {\n  return class WithAuth extends Component {\n    render() {\n      return (\n        <Consumer>\n          {(authStore) => {\n            return <Comp \n              isLogged={authStore.isLogged}\n              user={authStore.user}\n              logout={authStore.logout}\n              login={authStore.login}\n              signup={authStore.signup}\n              {...this.props} />\n          }}\n        </Consumer>\n      )\n    }    \n  }\n}\n\nexport default class AuthProvider extends Component {\n  state = {\n    isLogged: false,\n    user: {},\n    status: 'loading'\n  }\n\n  setUser = (user) => {\n    this.setState({\n      isLogged: true,\n      user,\n    })\n  }\n\n  logoutUser = () => {\n    return authService.logout()\n      .then(() => {\n        this.setState({ \n          isLogged: false,\n          user: {},\n        });\n      })\n      .catch( error => console.log(error))\n  }\n\n  loginUser = (body) => {\n    return authService.login(body)\n      .then((user) => {\n        this.setUser(user);\n      })\n      .catch(error => console.log(error))\n  }\n\n  signupUser = (body) => {\n    return authService.signup(body)\n      .then((user) => {\n        this.setUser(user);\n      })\n      .catch(error => console.log(error))\n  }\n\n  componentDidMount() {\n    authService.me()\n      .then((user) => {\n        this.setState({\n          isLogged: true,\n          user,\n          status: 'loaded'\n        })\n      })\n      .catch((error) => {\n        this.setState({ \n          isLogged: false,\n          user: {},\n          status: 'loaded'\n        });\n      })\n  }\n\n  render() {\n    const { isLogged, user, status } = this.state;\n    const { children } = this.props;\n    switch (status) {\n      case 'loading':\n        return <div>Loading</div>\n      default:\n        return (\n          <Provider value={\n            { isLogged,\n              user,\n              logout: this.logoutUser, \n              login: this.loginUser,\n              signup: this.signupUser,\n            }}>\n            {children}\n          </Provider>    \n        );\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}